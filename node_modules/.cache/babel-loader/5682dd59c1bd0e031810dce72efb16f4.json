{"ast":null,"code":"import _regeneratorRuntime from\"/home/johanna/Desktop/ElectricalEthereum/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/johanna/Desktop/ElectricalEthereum/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/johanna/Desktop/ElectricalEthereum/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import EthLogo from\"../assets/svg/eth_logo.svg\";import React,{Component,useEffect,useState}from\"react\";import Web3 from\"web3\";import{ABI,CONTRACT_ADDRESS,ELECTRICKEEPER_ABI,ELECTRICKEEPER_CONTRACT_ADDRESS}from\"../config\";import{BUTTON_OBJECT_4_LAST,BUTTON_OBJECT_4_FIRST}from\"./ButtonData\";import ErrorModal from\"../components/ErrorModal\";import{Web3ReactProvider,useWeb3React}from\"@web3-react/core\";import{DataContext}from\"../DataContext\";//TODO: add ErrorModal\n//MetaMask wallet shown/button if connect\n//Dropdown for network switch statements\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export default function Buy(_ref){var degree=_ref.degree,userLocation=_ref.userLocation,basic=_ref.basic;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),maticPriceFeedContract=_useState2[0],setMaticPriceFeedContract=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),electricKeeperContract=_useState4[0],setElectricKeeperContract=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),inputAmount=_useState6[0],setInputAmount=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),latestPriceOfMatic_1p=_useState8[0],setLatestPriceOfMatic_1p=_useState8[1];var _useState9=useState(),_useState10=_slicedToArray(_useState9,2),showToast=_useState10[0],setShowToast=_useState10[1];var _useState11=useState(\"\"),_useState12=_slicedToArray(_useState11,2),errorMsg=_useState12[0],setErrorMsg=_useState12[1];var _React$useContext=React.useContext(DataContext),userAccountAddress=_React$useContext.userAccountAddress,setUserAccountAddress=_React$useContext.setUserAccountAddress;var _useWeb3React=useWeb3React(),account=_useWeb3React.account;useEffect(function(){if(window.ethereum){window.ethereum.on(\"chainChanged\",function(){window.location.reload();});window.ethereum.on(\"accountsChanged\",function(){window.location.reload();});}var loadBlockchainData=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var web3,chainId,maticPriceFeedContract,electricKeeperContract;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:web3=new Web3(Web3.givenProvider||\"http://localhost:8545\");//const network = await web3.eth.net.getNetworkType();\n//await window.ethereum.enable();\n//const addressFromMetamask = await web3.eth.getAccounts();\n_context.next=3;return web3.eth.getChainId();case 3:chainId=_context.sent;console.log(chainId);if(chainId!==80001){setErrorMsg(\"Must be on the Mumbai test network\");}//Load the smart contract\nmaticPriceFeedContract=new web3.eth.Contract(ABI,CONTRACT_ADDRESS);electricKeeperContract=new web3.eth.Contract(ELECTRICKEEPER_ABI,ELECTRICKEEPER_CONTRACT_ADDRESS);setElectricKeeperContract(electricKeeperContract);setMaticPriceFeedContract(maticPriceFeedContract);console.log(maticPriceFeedContract,\"This is the matic price feed contract\");console.log(electricKeeperContract,\"This is electric keeper contract\");if(maticPriceFeedContract!==null){maticPriceFeedContract.methods.getLatestPrice().call().then(function(data){setLatestPriceOfMatic_1p(web3.utils.fromWei(data));console.log(data);console.log(web3.utils.fromWei(data));}).catch(function(err){console.log(err);});}case 13:case\"end\":return _context.stop();}}},_callee);}));return function loadBlockchainData(){return _ref2.apply(this,arguments);};}();loadBlockchainData();},[account]);useEffect(function(){console.log(\"matic Price Feed contract: \",maticPriceFeedContract);},[]);var estimatedMatic=function estimatedMatic(){return latestPriceOfMatic_1p&&inputAmount!==\"\"?(latestPriceOfMatic_1p*(10*inputAmount)).toFixed(3).toString():\"0\";};var handleBuyButtonClick=function handleBuyButtonClick(colorNumber){console.log(\"You chose the color:\",colorNumber);console.log(account,\"account in BUY handle click\");try{var web3=new Web3(window.web3.currentProvider);var amountOfMaticToPay=estimatedMatic();console.log(amountOfMaticToPay);web3.eth.sendTransaction({to:ELECTRICKEEPER_CONTRACT_ADDRESS,data:electricKeeperContract.methods.BuyElectricityTimeOn(colorNumber,web3.utils.toWei(amountOfMaticToPay)).encodeABI(),value:web3.utils.toWei(amountOfMaticToPay),from:account});}catch(err){var msg=\"Connect your wallet to buy\";console.log(err,msg);setErrorMsg(msg);}};var renderInputBox=function renderInputBox(){return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:150,marginTop:50,display:\"flex\",alignItems:\"center\",flexDirection:\"column\"},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",flexDirection:\"column\",width:\"50%\"},children:[/*#__PURE__*/_jsx(\"label\",{style:{color:\"#ffdd9a\",marginRight:\"20px\",fontSize:\"13px\"},htmlFor:\"minutes\",children:\"price: $0.10/minute\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",class:\"input-matic\",min:\"0\",step:\"1\",placeholder:\"enter amount of minutes\",\"data-name\":\"minutes\",value:inputAmount,onChange:function onChange(e){return setInputAmount(e.target.value);},style:{width:\"100%\"}})]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"label\",{style:{color:\"#ffdd9a\",fontSize:\"13px\"},htmlFor:\"minutes\",children:\"pick LED color to buy\"}),/*#__PURE__*/_jsxs(\"div\",{style:{width:\"80%\"},children:[BUTTON_OBJECT_4_FIRST.map(function(i){return/*#__PURE__*/_jsx(\"button\",{className:i.styleClass,onClick:function onClick(){return handleBuyButtonClick(i.buttonClickValue);},children:i.title});}),/*#__PURE__*/_jsx(\"br\",{}),BUTTON_OBJECT_4_LAST.map(function(i){return/*#__PURE__*/_jsx(\"button\",{className:i.styleClass,onClick:function onClick(){return handleBuyButtonClick(i.buttonClickValue);},children:i.title});})]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Amount: \"}),\" \\xA0\\xA0\\xA0\\xA0 \\u2248 \\xA0\",\" \",estimatedMatic(),\" matic\"]})]})});};return/*#__PURE__*/_jsxs(\"div\",{class:\"container\",children:[/*#__PURE__*/_jsx(\"div\",{class:\"row\",children:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"h1\",{children:[/*#__PURE__*/_jsx(\"br\",{}),\"buy electricity\"]}),/*#__PURE__*/_jsx(\"p\",{children:\"enter the amount of minutes of electricity you want to buy \"}),/*#__PURE__*/_jsx(\"div\",{className:\"row\",children:renderInputBox()})]})}),errorMsg!==\"\"?/*#__PURE__*/_jsx(ErrorModal,{showToastFromProp:errorMsg!==\"\",onClose:function onClose(){return setErrorMsg(\"\");},errorMsg:errorMsg}):null]});}","map":{"version":3,"sources":["/home/johanna/Desktop/ElectricalEthereum/frontend/src/pages/Buy.js"],"names":["React","Component","useEffect","useState","Web3","ABI","CONTRACT_ADDRESS","ELECTRICKEEPER_ABI","ELECTRICKEEPER_CONTRACT_ADDRESS","BUTTON_OBJECT_4_LAST","BUTTON_OBJECT_4_FIRST","ErrorModal","Web3ReactProvider","useWeb3React","DataContext","Buy","degree","userLocation","basic","maticPriceFeedContract","setMaticPriceFeedContract","electricKeeperContract","setElectricKeeperContract","inputAmount","setInputAmount","latestPriceOfMatic_1p","setLatestPriceOfMatic_1p","showToast","setShowToast","errorMsg","setErrorMsg","useContext","userAccountAddress","setUserAccountAddress","account","window","ethereum","on","location","reload","loadBlockchainData","web3","givenProvider","eth","getChainId","chainId","console","log","Contract","methods","getLatestPrice","call","then","data","utils","fromWei","catch","err","estimatedMatic","toFixed","toString","handleBuyButtonClick","colorNumber","currentProvider","amountOfMaticToPay","sendTransaction","to","BuyElectricityTimeOn","toWei","encodeABI","value","from","msg","renderInputBox","marginBottom","marginTop","display","alignItems","flexDirection","width","color","marginRight","fontSize","e","target","map","i","styleClass","buttonClickValue","title"],"mappings":"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","sourcesContent":["import EthLogo from \"../assets/svg/eth_logo.svg\";\nimport React, { Component, useEffect, useState } from \"react\";\nimport Web3 from \"web3\";\nimport {\n  ABI,\n  CONTRACT_ADDRESS,\n  ELECTRICKEEPER_ABI,\n  ELECTRICKEEPER_CONTRACT_ADDRESS,\n} from \"../config\";\nimport { BUTTON_OBJECT_4_LAST, BUTTON_OBJECT_4_FIRST } from \"./ButtonData\";\nimport ErrorModal from \"../components/ErrorModal\";\nimport { Web3ReactProvider, useWeb3React } from \"@web3-react/core\";\n\nimport { DataContext } from \"../DataContext\";\n\n//TODO: add ErrorModal\n//MetaMask wallet shown/button if connect\n//Dropdown for network switch statements\n\nexport default function Buy({ degree, userLocation, basic }) {\n  const [maticPriceFeedContract, setMaticPriceFeedContract] = useState(null);\n  const [electricKeeperContract, setElectricKeeperContract] = useState(null);\n\n  const [inputAmount, setInputAmount] = useState(\"\");\n  const [latestPriceOfMatic_1p, setLatestPriceOfMatic_1p] = useState(\"\");\n  const [showToast, setShowToast] = useState();\n  const [errorMsg, setErrorMsg] = useState(\"\");\n  const { userAccountAddress, setUserAccountAddress } =\n    React.useContext(DataContext);\n\n  const { account } = useWeb3React();\n\n  useEffect(() => {\n    if (window.ethereum) {\n      window.ethereum.on(\"chainChanged\", () => {\n        window.location.reload();\n      });\n      window.ethereum.on(\"accountsChanged\", () => {\n        window.location.reload();\n      });\n    }\n    const loadBlockchainData = async () => {\n      const web3 = new Web3(Web3.givenProvider || \"http://localhost:8545\");\n      //const network = await web3.eth.net.getNetworkType();\n      //await window.ethereum.enable();\n      //const addressFromMetamask = await web3.eth.getAccounts();\n      const chainId = await web3.eth.getChainId();\n      console.log(chainId);\n      if (chainId !== 80001) {\n        setErrorMsg(\"Must be on the Mumbai test network\");\n      }\n\n      //Load the smart contract\n      const maticPriceFeedContract = new web3.eth.Contract(\n        ABI,\n        CONTRACT_ADDRESS\n      );\n      const electricKeeperContract = new web3.eth.Contract(\n        ELECTRICKEEPER_ABI,\n        ELECTRICKEEPER_CONTRACT_ADDRESS\n      );\n      setElectricKeeperContract(electricKeeperContract);\n      setMaticPriceFeedContract(maticPriceFeedContract);\n      console.log(\n        maticPriceFeedContract,\n        \"This is the matic price feed contract\"\n      );\n      console.log(electricKeeperContract, \"This is electric keeper contract\");\n\n      if (maticPriceFeedContract !== null) {\n        maticPriceFeedContract.methods\n          .getLatestPrice()\n          .call()\n          .then((data) => {\n            setLatestPriceOfMatic_1p(web3.utils.fromWei(data));\n            console.log(data);\n            console.log(web3.utils.fromWei(data));\n          })\n          .catch((err) => {\n            console.log(err);\n          });\n      }\n    };\n    loadBlockchainData();\n  }, [account]);\n\n  useEffect(() => {\n    console.log(\"matic Price Feed contract: \", maticPriceFeedContract);\n  }, []);\n\n  const estimatedMatic = () => {\n    return latestPriceOfMatic_1p && inputAmount !== \"\"\n      ? (latestPriceOfMatic_1p * (10 *  inputAmount)).toFixed(3).toString()\n      : \"0\";\n  };\n\n  const handleBuyButtonClick = (colorNumber) => {\n    console.log(\"You chose the color:\", colorNumber);\n    console.log(account, \"account in BUY handle click\");\n    try {\n      let web3 = new Web3(window.web3.currentProvider);\n      let amountOfMaticToPay = estimatedMatic();\n      console.log(amountOfMaticToPay);\n      web3.eth.sendTransaction({\n        to: ELECTRICKEEPER_CONTRACT_ADDRESS,\n        data: electricKeeperContract.methods\n          .BuyElectricityTimeOn(colorNumber, web3.utils.toWei(amountOfMaticToPay))\n          .encodeABI(),\n        value: web3.utils.toWei(amountOfMaticToPay),\n        from: account,\n      });\n    } catch (err) {\n      const msg = \"Connect your wallet to buy\";\n      console.log(err, msg);\n      setErrorMsg(msg);\n    }\n  };\n\n\n\n  const renderInputBox = () => {\n    return (\n      <>\n        <div\n          style={{\n            marginBottom: 150,\n            marginTop: 50,\n            display: \"flex\",\n            alignItems: \"center\",\n            flexDirection: \"column\",\n          }}\n        >\n          <div\n            style={{ display: \"flex\", flexDirection: \"column\", width: \"50%\" }}\n          >\n            <label\n              style={{\n                color: \"#ffdd9a\",\n                marginRight: \"20px\",\n                fontSize: \"13px\",\n              }}\n              htmlFor=\"minutes\"\n            >\n              price: $0.10/minute\n            </label>\n            <input\n              type=\"number\"\n              class=\"input-matic\"\n              min=\"0\"\n              step=\"1\"\n              placeholder=\"enter amount of minutes\"\n              data-name=\"minutes\"\n              value={inputAmount}\n              onChange={(e) => setInputAmount(e.target.value)}\n              style={{ width: \"100%\" }}\n            ></input>\n          </div>\n          <br />\n          <label\n            style={{\n              color: \"#ffdd9a\",\n              fontSize: \"13px\",\n            }}\n            htmlFor=\"minutes\"\n          >\n            pick LED color to buy\n          </label>\n          <div style={{ width: \"80%\" }}>\n            {BUTTON_OBJECT_4_FIRST.map((i) => (\n              <button\n                className={i.styleClass}\n                onClick={() => handleBuyButtonClick(i.buttonClickValue)}\n              >\n                {i.title}\n              </button>\n            ))}\n            <br></br>\n            {BUTTON_OBJECT_4_LAST.map((i) => (\n              <button\n                className={i.styleClass}\n                onClick={() => handleBuyButtonClick(i.buttonClickValue)}\n              >\n                {i.title}\n              </button>\n            ))}\n          </div>\n          <br />\n          <p>\n            <b>Amount: </b> &nbsp;&nbsp;&nbsp;&nbsp; ≈ &nbsp;{\" \"}\n            {estimatedMatic()} matic\n          </p>\n        </div>\n      </>\n    );\n  };\n\n  return (\n    <div class=\"container\">\n      <div class=\"row\">\n        <div>\n          <h1>\n            <br></br>\n            buy electricity\n          </h1>\n          <p>enter the amount of minutes of electricity you want to buy </p>\n          <div className=\"row\">{renderInputBox()}</div>\n        </div>\n      </div>\n      {errorMsg !== \"\" ? (\n        <ErrorModal\n          showToastFromProp={errorMsg !== \"\"}\n          onClose={() => setErrorMsg(\"\")}\n          errorMsg={errorMsg}\n        ></ErrorModal>\n      ) : null}\n    </div>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}